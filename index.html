<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Esquiva Chuy</title>
<style>
    body {
        margin: 0;
        background: #8ec6ff;
        font-family: Arial, sans-serif;
        text-align: center;
    }

    h1 {
        margin-top: 20px;
        font-size: 40px;
        font-weight: bold;
    }

    #gameBox {
        width: 900px;
        height: 350px;
        background: linear-gradient(white 60%, #e8c68a 60%);
        margin: 20px auto;
        border: 4px solid black;
        border-radius: 10px;
        position: relative;
        overflow: hidden;
    }

    #chuy {
        position: absolute;
        bottom: 60px;
        width: 70px;
        transition: 0.1s;
    }

    /* Agachado */
    .crouch {
        transform: translateY(-25px) scaleY(0.6);
    }

    /* Cactus nuevo minimalista */
    .cactus {
        position: absolute;
        bottom: 60px;
        width: 35px;
        height: 60px;
        background: #1d8f34;
        border-radius: 6px;
    }

    #score {
        position: absolute;
        top: 10px;
        left: 10px;
        font-size: 20px;
        font-weight: bold;
    }

    #deadMsg {
        position: absolute;
        top: 90px;
        left: 50%;
        transform: translateX(-50%);
        padding: 20px;
        font-size: 25px;
        border-radius: 10px;
        background: white;
        color: red;
        display: none;
        border: 3px solid red;
    }

    /* Controles abajo IZQUIERDA DE LA PÁGINA */
    #controles {
        position: fixed;
        bottom: 20px;
        left: 20px;
        font-size: 18px;
        background: white;
        padding: 10px 15px;
        border-radius: 10px;
        border: 2px solid black;
    }

    /* Selector de skins */
    #skinBtn {
        margin-top: 15px;
        font-size: 20px;
        padding: 10px 20px;
        border-radius: 10px;
        cursor: pointer;
        border: 2px solid black;
        background: white;
    }

</style>
</head>
<body>

<h1>Esquiva Chuy</h1>

<div id="gameBox">
    <div id="score">Puntaje: 0</div>

    <img id="chuy" src="chuy.png">

    <div id="deadMsg">Estas muerto presiona R para reiniciar</div>
</div>

<button id="skinBtn">Chuy (click para cambiar)</button>

<!-- Controles fuera del gameplay -->
<div id="controles">
    Espacio = saltar<br>
    B = agacharse<br>
    R = reiniciar
</div>

<script>
let gameBox = document.getElementById("gameBox");
let chuy = document.getElementById("chuy");
let scoreTxt = document.getElementById("score");
let deadMsg = document.getElementById("deadMsg");
let skinBtn = document.getElementById("skinBtn");

let currentSkin = "chuy";
let skins = ["chuy", "mangonio"];
let skinIndex = 0;

let jumping = false;
let yVel = 0;
let gravity = 1.1;
let isDead = false;
let score = 0;

/* Cambiar skins */
skinBtn.onclick = () => {
    skinIndex = (skinIndex + 1) % skins.length;
    currentSkin = skins[skinIndex];
    skinBtn.innerText = currentSkin + " (click para cambiar)";
    chuy.src = currentSkin + ".png";
};

/* Crear cactus */
function spawnCactus() {
    if (isDead) return;

    let c = document.createElement("div");
    c.classList.add("cactus");
    c.style.left = "900px";
    gameBox.appendChild(c);

    let speed = 6; // Velocidad rápida
    let move = setInterval(() => {
        if (isDead) { clearInterval(move); c.remove(); }

        let x = parseInt(c.style.left);
        c.style.left = (x - speed) + "px";

        // Colisión
        if (x < 120 && x > 50) {
            if (!chuy.classList.contains("crouch") || parseInt(chuy.style.bottom) > 90) {
                die();
            }
        }

        if (x < -50) {
            c.remove();
        }
    }, 20);

    setTimeout(spawnCactus, 900 + Math.random() * 600);
}

spawnCactus();

/* Game loop */
setInterval(() => {
    if (!isDead) {
        score += 1; // Puntaje más rápido
        scoreTxt.innerText = "Puntaje: " + score;
    }

    if (jumping) {
        let bottom = parseInt(chuy.style.bottom || 60);
        bottom += yVel;
        yVel -= gravity;

        if (bottom <= 60) {
            bottom = 60;
            jumping = false;
        }

        chuy.style.bottom = bottom + "px";
    }

}, 30);

/* SALTAR */
document.addEventListener("keydown", e => {
    if (e.code === "Space" && !jumping && !isDead) {
        jumping = true;
        yVel = 16;
    }

    if (e.key === "b" && !isDead) {
        chuy.classList.add("crouch");
    }

    if (e.key === "r") resetGame();
});

document.addEventListener("keyup", e => {
    if (e.key === "b") chuy.classList.remove("crouch");
});

/* MORIR */
function die() {
    isDead = true;
    deadMsg.style.display = "block";
    chuy.src = currentSkin + "1.png";
}

/* REINICIAR */
function resetGame() {
    isDead = false;
    score = 0;
    deadMsg.style.display = "none";
    chuy.src = currentSkin + ".png";
}
</script>

</body>
</html>
