<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Esquiva Chuy</title>
<style>
    body {
        background:#87CEEB;
        margin:0;
        font-family:Arial;
        user-select:none;
    }

    #gameContainer {
        width:800px;
        height:300px;
        background:white;
        margin:30px auto 10px auto;
        position:relative;
        border:3px solid black;
    }

    #chuy {
        position:absolute;
        bottom:0;
        width:50px;
        height:50px;
        transition:0.1s;
    }

    #cactus {
        position:absolute;
        bottom:0;
        width:25px;
        height:45px;
        background:#228B22;
        border-radius:6px;
        box-shadow:
            8px -15px 0 #228B22,
            -8px -10px 0 #228B22;
    }

    #menuSkins {
        text-align:center;
        margin-top:10px;
    }

    .skinBtn {
        padding:10px 20px;
        border:2px solid black;
        background:white;
        display:inline-block;
        cursor:pointer;
        margin:5px;
    }

    #score {
        text-align:center;
        font-size:22px;
        font-weight:bold;
    }

    #controles {
        position:absolute;
        bottom:10px;
        left:10px;
        font-size:16px;
        font-weight:bold;
    }

    #startScreen {
        width:100%;
        text-align:center;
        margin-top:40px;
    }

    #startBtn {
        padding:12px 25px;
        border:2px solid black;
        background:white;
        cursor:pointer;
        font-size:18px;
    }
</style>
</head>
<body>

<div id="startScreen">
    <h1 style="font-size:40px; margin-bottom:5px;">ESQUIVA CHUY</h1>
    <p>Presiona el boton para jugar</p>
    <div id="startBtn">Iniciar</div>
</div>

<div id="gameContainer" style="display:none;">
    <img id="chuy" src="chuy.png">
    <div id="cactus"></div>
    <div id="controles">espacio para saltar  b para agacharse  r para reiniciar</div>
</div>

<div id="score">Puntos: 0</div>

<div id="menuSkins">
    <div class="skinBtn" onclick="cambiarSkin('chuy.png')">Chuy</div>
    <div class="skinBtn" onclick="cambiarSkin('mangonio.png')">Cambiar a Mangonio</div>
</div>

<script>
let personaje = document.getElementById("chuy");
let cactus = document.getElementById("cactus");
let scoreText = document.getElementById("score");
let game = document.getElementById("gameContainer");

let vivo = true;
let saltando = false;
let agachado = false;
let puntos = 0;
let speed = 6; // velocidad correcta del personaje
let cactusSpeed = 6;
let scoreSpeed = 40; // mas lento

let cactusX = 800;

function cambiarSkin(skin){
    if(!saltando){  
        personaje.src = skin;
    }
}

document.getElementById("startBtn").onclick = () => {
    document.getElementById("startScreen").style.display="none";
    game.style.display="block";
};

function loop(){
    if(vivo){
        cactusX -= cactusSpeed;

        if(cactusX < -40){
            cactusX = 800;
        }

        cactus.style.left = cactusX + "px";

        if(scoreSpeed === 0){
            puntos++;
            scoreSpeed = 40; 
        } else {
            scoreSpeed--;
        }

        scoreText.innerHTML = "Puntos: " + puntos;

        let pjLeft = 50;
        let pjRight = pjLeft + 50;
        let pjBottom = agachado ? 10 : 0;
        let pjTop = pjBottom + (agachado ? 25 : 50);

        let cxLeft = cactusX;
        let cxRight = cactusX + 25;
        let cxBottom = 0;
        let cxTop = 45;

        if(pjRight > cxLeft && pjLeft < cxRight && pjTop > cxBottom && pjBottom < cxTop){
            vivo = false;
        }
    }
    requestAnimationFrame(loop);
}

document.addEventListener("keydown", e=>{
    if(e.key === " " && vivo){
        saltar();
    }
    if(e.key === "b" && vivo){
        agachar();
    }
    if(e.key === "r"){
        reiniciar();
    }
});

function saltar(){
    if(saltando || agachado) return;

    saltando = true;
    let up = 0;
    let saltoInterval = setInterval(()=>{
        personaje.style.bottom = up + "px";
        up += 6;
        if(up >= 120){
            clearInterval(saltoInterval);

            let downInt = setInterval(()=>{
                up -= 6;
                personaje.style.bottom = up + "px";
                if(up <= 0){
                    clearInterval(downInt);
                    personaje.style.bottom = "0px";
                    saltando = false;
                }
            },15);
        }
    },15);
}

function agachar(){
    if(saltando) return;

    if(!agachado){
        personaje.style.height = "25px";
        agachado = true;
    }

    setTimeout(()=>{
        if(agachado){
            personaje.style.height = "50px";
            agachado = false;
        }
    },300);
}

function reiniciar(){
    vivo = true;
    cactusX = 800;
    puntos = 0;
    personaje.style.bottom = "0px";
    personaje.style.height = "50px";
    agachado = false;
}

loop();
</script>
</body>
</html>
